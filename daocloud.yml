image: ubuntu:14.04

env:
    - MYENV = "hello openwrt"

install:
    - echo $MYENV
    - echo "This is an install segment"
    - echo "Here, we usually run scripts to setup a base environment"
    - pwd
    - ls
    - sudo apt-get update -qq
    - sudo apt-get install -y wget curl python git subversion build-essential libncurses5-dev zlib1g-dev gawk ccache gettext libssl-dev xsltproc

before_script:
    - echo $MYENV
    - echo "This is an before_script segment"
    - echo "Here, we usually run scripts to prepare our test"
    - pwd
    - ls
    - ls ./install_openwrt_sdk.sh
    - bash install_openwrt_sdk.sh
    - ln -s $PWD ~/openwrt/hc5761/package/feeds
    - git diff --name-only HEAD^ HEAD | xargs dirname

script:
    - echo "This is an script segment"
    - pwd
    - ls
    - cd ~/openwrt/hc5761
    - make defconfig
    - echo "CONFIG_PACKAGE_wifidog=m" >> .config
    - make package/feeds/net/wifidog/compile V=99
    - ls bin/ralink/packages/wifidog*
